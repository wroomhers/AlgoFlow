<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Algoritma ve Akış Diyagramı Editörü</title>

    <!-- P5.js Libraries -->
    <script src="kutuphane/p5.js" type="text/javascript"></script>
    <script src="kutuphane/p5.dom.js" type="text/javascript"></script>
    <script src="kutuphane/p5.sound.js" type="text/javascript"></script>

    <!-- App Scripts -->
    <script src="ana_program.js" type="text/javascript"></script>
    <script src="ozellik_menu.js" type="text/javascript"></script>
    <script src="algoritma_akıs_diagram.js" type="text/javascript"></script>
    <script src="bagla.js" type="text/javascript"></script>
    <script src="simülasyon.js" type="text/javascript"></script>
    <script src="konsol.js" type="text/javascript"></script>

    <link href="style.css" rel="stylesheet" type="text/css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>

<div class="app-container">
    <!-- Header/Toolbar -->
    <div class="toolbar">
        <div class="logo">AlgoFlow <i class="fa-solid fa-diagram-project"></i></div>
        <div class="controls">
            <div class="btn-group">
                <button class="btn btn-primary" onclick="dosyaKaydet()" title="Projeyi Kaydet"><i class="fa-solid fa-download"></i> Kaydet</button>
                <button class="btn btn-primary" onclick="dosyaYukle()" title="Proje Yükle"><i class="fa-solid fa-upload"></i> Yükle</button>
                <button class="btn btn-warning" onclick="yeniProje()" title="Yeni Proje"><i class="fa-solid fa-file"></i> Yeni</button>
            </div>
            <div class="btn-separator"></div>
            <button id="btn-run" class="btn btn-success" onclick="baslatSimulasyon()"><i class="fa-solid fa-play"></i> Çalıştır</button>
            <button id="btn-step" class="btn btn-primary" onclick="adimSimulasyon()"><i class="fa-solid fa-forward-step"></i> Adım</button>
            <button id="btn-stop" class="btn btn-danger" onclick="durdurSimulasyon()"><i class="fa-solid fa-stop"></i> Durdur</button>
            <div class="btn-separator"></div>
            <!-- Simülasyon Hızı Kontrolü -->
            <div class="speed-control">
                <button class="btn btn-sm" onclick="hiziAzalt()" title="Yavaşlat"><i class="fa-solid fa-backward"></i></button>
                <span class="speed-label">Hız: <span id="sim-speed">1000</span>ms</span>
                <button class="btn btn-sm" onclick="hiziArtir()" title="Hızlandır"><i class="fa-solid fa-forward"></i></button>
            </div>
        </div>
    </div>

    <div class="main-content">
        <!-- Left Sidebar: Toolbox -->
        <div class="sidebar left-sidebar">
            <div class="sidebar-header">Araç Kutusu</div>
            <div class="toolbox-items">
                <div class="toolbox-btn" draggable="true" ondragstart="dragStartHandler(event, 3, 'BAŞLAT')" onclick="sekilEkle(3, 'BAŞLAT')">
                    <div class="shape shape-start"></div>
                    <span>Başlat / Durdur</span>
                </div>
                <div class="toolbox-btn" draggable="true" ondragstart="dragStartHandler(event, 1, 'İşlem')" onclick="sekilEkle(1, 'İşlem')">
                    <div class="shape shape-process"></div>
                    <span>İşlem</span>
                </div>
                <div class="toolbox-btn" draggable="true" ondragstart="dragStartHandler(event, 2, 'Giriş/Çıkış')" onclick="sekilEkle(2, 'Giriş/Çıkış')">
                    <div class="shape shape-io"></div>
                    <span>Giriş / Çıkış</span>
                </div>
                <div class="toolbox-btn" draggable="true" ondragstart="dragStartHandler(event, 4, 'Karar')" onclick="sekilEkle(4, 'Karar')">
                    <div class="shape shape-decision"></div>
                    <span>Karar</span>
                </div>
            </div>
            
            <!-- Bağlantı Bilgilendirme -->
            <div class="toolbox-info">
                <div class="sidebar-header" style="font-size:11px;">Bağlantı Oluşturma</div>
                <div style="padding:10px; font-size:11px; color:#888;">
                    <p>1. Bloğa fareyi yaklaştırın</p>
                    <p>2. Görünen bağlantı noktasına tıklayın</p>
                    <p>3. Hedef bloğun noktasına tıklayın</p>
                    <p style="margin-top:5px;"><em>ESC: İptal | DELETE: Sil</em></p>
                </div>
            </div>
        </div>

        <!-- Center: Canvas -->
        <div id="canvas-container" class="canvas-area" ondragover="dragOverHandler(event)" ondrop="dropHandler(event)">
            <!-- p5.js canvas will be injected here -->
        </div>

        <!-- Right Sidebar: Properties & Console -->
        <div class="sidebar right-sidebar">
            <div class="panel properties-panel">
                <div class="sidebar-header">Özellikler</div>
                <div id="properties-content" class="panel-content">
                    <div class="no-selection">Bir nesne seçin</div>
                    
                    <div id="prop-form" style="display:none;">
                        <div class="form-group">
                            <label>Metin:</label>
                            <input type="text" id="prop-text" oninput="guncelleSekilMetni(this.value)">
                        </div>

                        <div class="form-group" style="display: flex; gap: 10px;">
                            <div style="flex:1;">
                                <label>Arkaplan:</label>
                                <input type="color" id="prop-fill-color" oninput="anlikOzellikGuncelle('arkaPlanRengi', this.value)" style="width:100%; height:30px; cursor:pointer; padding:0; border:none; background:none;">
                            </div>
                            <div style="flex:1;">
                                <label>Yazı Rengi:</label>
                                <input type="color" id="prop-text-color" oninput="anlikOzellikGuncelle('yaziRengi', this.value)" style="width:100%; height:30px; cursor:pointer; padding:0; border:none; background:none;">
                            </div>
                        </div>
                        
                        <!-- Dynamic fields based on shape type can go here -->
                        <div id="var-group-container">
                            <div class="form-group" id="code-group">
                                 <label id="lbl-code">Kod / İşlem:</label>
                                 <input type="text" id="prop-code" placeholder="x = 5 veya x > 10" oninput="anlikOzellikGuncelle('kod', this.value)">
                            </div>
                            <p style="font-size:11px; color:#666; margin-top:5px;">
                                <strong>İşlem:</strong> x = 5 + y<br>
                                <strong>Karar:</strong> x > 10<br>
                                <strong>Çıktı:</strong> "Merhaba" veya x
                            </p>
                        </div>
                        
                        <div class="prop-actions">
                            <button class="btn btn-sm btn-danger" onclick="asilSilmeIslemi()" title="Bloğu Sil"><i class="fa-solid fa-trash"></i> Bloğu Sil</button>
                            <button class="btn btn-sm btn-warning" onclick="baglantiSil()" title="Bağlantıları Sil"><i class="fa-solid fa-link-slash"></i> Bağlantıları Sil</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="panel console-panel">
                <div class="sidebar-header">
                     <span style="margin-right:10px;">Çıktı</span> / <span style="margin-left:10px; color:#aaa;">Log</span>
                </div>
                
                <!-- Tab headers -->
                <div style="display:flex; border-bottom:1px solid #444;">
                    <button class="tab-btn active" onclick="tabGecis('cikti')" id="btn-tab-cikti">Program Çıktısı</button>
                    <button class="tab-btn" onclick="tabGecis('log')" id="btn-tab-log">Simülasyon Log</button>
                </div>

                <div id="console-output-cikti" class="console-output" style="display:block;">
                    <div class="console-line system">> Program çıktısı burada görünecek.</div>
                </div>
                <div id="console-output-log" class="console-output" style="display:none;">
                    <div class="console-line system">> Simülasyon adımları buraya düşer.</div>
                </div>
                
                <button class="btn-clear-console" onclick="temizleKonsol()">Temizle</button>
            </div>
        </div>
    </div>
</div>

</body>
</html>
